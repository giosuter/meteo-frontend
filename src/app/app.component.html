<div class="container">
  <header class="header">
    <h1>{{ title }}</h1>

    <div class="controls">
      <input
        [(ngModel)]="city"
        (keyup.enter)="refreshAll()"
        placeholder="City (e.g., Roma)"
        aria-label="City"
      />

      <input
        [(ngModel)]="country"
        (keyup.enter)="refreshAll()"
        (blur)="country = (country || '').trim().toUpperCase()"
        placeholder="Country (ISO-2, optional)"
        aria-label="Country code"
        maxlength="2"
      />

      <button type="button" (click)="refreshAll()" [disabled]="loading()">
        {{ loading() ? "Loading…" : "Search" }}
      </button>
    </div>
  </header>

  <!-- Error -->
  <div class="error" *ngIf="error() as e">{{ e }}</div>

  <!-- Current (card) -->
  <section class="card current" *ngIf="current as c">
    <div class="current-left">
      <h2>Today — {{ c.city }}, {{ c.country }}</h2>
      <div class="temp">{{ c.temp | number : "1.0-1" }}°C</div>
      <div class="desc">{{ c.description }}</div>
      <div class="meta">
        <span>Feels: {{ c.feelsLike | number : "1.0-1" }}°C</span>
        <span>Humidity: {{ c.humidity }}%</span>
        <span>Wind: {{ c.windKph | number : "1.0-0" }} km/h</span>
      </div>
      <div class="sun">
        <span>Sunrise: {{ toLocalTime(c.sunrise) }}</span>
        <span>Sunset: {{ toLocalTime(c.sunset) }}</span>
      </div>
    </div>
    <div class="current-right">
      <img
        class="wx-icon"
        [src]="getIconPath(c.icon)"
        width="100"
        height="100"
        alt="Weather icon"
      />
    </div>
  </section>

  <!-- Forecast (card) -->
  <section class="card forecast" *ngIf="forecast as f">
    <h2>Next days — {{ f.city }}, {{ f.country }}</h2>
    <div class="forecast-grid">
      <div class="day" *ngFor="let d of f.days">
        <div class="date">{{ d.date | date : "dd.MM.yyyy" }}</div>
        <img
          class="wx-icon small"
          [src]="getIconPath(d.icon)"
          width="60"
          height="60"
          alt="Icon"
        />
        <div class="range">
          <span class="max">{{ d.max | number : "1.0-1" }}°</span>
          <span class="min">{{ d.min | number : "1.0-1" }}°</span>
        </div>
        <div class="desc">{{ d.description }}</div>
        <div class="pop">POP: {{ d.pop }}%</div>
      </div>
    </div>
  </section>
</div>
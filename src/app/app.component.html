<div class="container">
  <!-- Header -->
  <header class="header">
    <h1>{{ "TITLE" | translate }}</h1>

    <div class="controls">
      <!-- Language selector (template-safe cast) -->
      <select
        [ngModel]="selectedLang"
        (ngModelChange)="changeLang($event)"
      >
        <option *ngFor="let l of ['en','de','fr','it','hu']" [value]="l">
          {{ l | uppercase }}
        </option>
      </select>

      <!-- City -->
      <input
        [(ngModel)]="city"
        (keyup.enter)="refreshAll()"
        placeholder="{{ 'CITY_PLACEHOLDER' | translate }}"
        aria-label="City"
      />

      <!-- Country -->
      <input
        [(ngModel)]="country"
        (keyup.enter)="refreshAll()"
        (blur)="country = (country || '').trim().toUpperCase()"
        placeholder="{{ 'COUNTRY_PLACEHOLDER' | translate }}"
        aria-label="Country code"
        maxlength="2"
      />

      <!-- Search -->
      <button type="button" (click)="refreshAll()" [disabled]="loading()">
        {{ loading() ? ("LOADING" | translate) : ("SEARCH" | translate) }}
      </button>
    </div>
  </header>

  <!-- Error -->
  <div class="error" *ngIf="error() as e">{{ e }}</div>

  <!-- Current (card) -->
  <section class="card current" *ngIf="current as c">
    <div class="current-left">
      <h2>{{ "TODAY" | translate : { city: c.city, country: c.country } }}</h2>

      <div class="temp">{{ c.temp | number : "1.0-1" }}°C</div>

      <!-- Localized description (no regex here) -->
      <div class="desc">{{ tDesc(c.description) }}</div>

      <div class="meta">
        <span>
          {{
            "FEELS_LIKE"
              | translate : { value: (c.feelsLike | number : "1.0-1") }
          }}
        </span>
        <span>
          {{ "HUMIDITY" | translate : { value: c.humidity } }}
        </span>
        <span>
          {{ "WIND" | translate : { value: (c.windKph | number : "1.0-0") } }}
        </span>
      </div>

      <div class="sun">
        <span>
          {{ "SUNRISE" | translate : { value: toLocalTime(c.sunrise) } }}
        </span>
        <span>
          {{ "SUNSET" | translate : { value: toLocalTime(c.sunset) } }}
        </span>
      </div>
    </div>

    <div class="current-right">
      <img
        class="wx-icon"
        [src]="getIconPath(c.icon)"
        width="100"
        height="100"
        alt="Weather icon"
      />
    </div>
  </section>

  <!-- Forecast (card) -->
  <section class="card forecast" *ngIf="forecast as f">
    <h2>
      {{ "NEXT_DAYS" | translate : { city: f.city, country: f.country } }}
    </h2>

    <div class="forecast-grid">
      <div class="day" *ngFor="let d of f.days">
        <div class="date">{{ d.date | date : "dd.MM.yyyy" }}</div>

        <img
          class="wx-icon small"
          [src]="getIconPath(d.icon)"
          width="60"
          height="60"
          alt="Icon"
        />

        <div class="range">
          <span class="max">{{ d.max | number : "1.0-1" }}°</span>
          <span class="min">{{ d.min | number : "1.0-1" }}°</span>
        </div>

        <!-- Localized description (no regex here) -->
        <div class="desc">{{ tDesc(d.description) }}</div>

        <div class="pop">
          {{ "POP" | translate : { value: d.pop } }}
        </div>
      </div>
    </div>
  </section>
</div>